import socket

def resolve_hostname(hostname):
    try:
        return socket.gethostbyname(hostname)
    except socket.error:
        return None

def is_valid_ip(ip):
    try:
        socket.inet_aton(ip)
        return True
    except socket.error:
        return False

def port_range_string(start, end):
    return f"{start}-{end}"

def get_common_ports():
    return [21, 22, 23, 25, 53, 80, 110, 143, 443, 3306, 3389, 8080]

def format_scan_summary(results):
    summary = []
    for port, info in results['ports'].items():
        summary.append(f"Port {port}/{info['name']}: {info['state']}, Banner: {info['banner']}, CVEs: {', '.join(info['cves']) if info['cves'] else 'None'}")
    return "\n".join(summary)

def save_raw_result(results, filename="results/last_scan_raw.json"):
    import json
    with open(filename, "w") as f:
        json.dump(results, f, indent=4)
    return filename
